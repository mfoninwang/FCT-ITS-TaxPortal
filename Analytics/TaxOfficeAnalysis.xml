<?xml version="1.0" encoding="utf-8"?>
<Dashboard CurrencyCulture="ha-Latn-NG">
  <Title Text="Tax Office Dashboard" />
  <DataConnections>
    <OlapDataConnection Name="CollectionsCubeCon" ConnectionString="provider=msolap;data source=localhost;initial catalog=FIRSCollectionsOLAP;timeout=1200;Cube Name=CollectionsCube;" />
    <DataConnection Name="firs_portalCon" ProviderKey="MSSqlServer">
      <Parameters>
        <Parameter Name="server" Value="204.242.131.111" />
        <Parameter Name="database" Value="firs_portal" />
        <Parameter Name="useIntegratedSecurity" Value="False" />
        <Parameter Name="read only" Value="1" />
        <Parameter Name="generateConnectionHelper" Value="false" />
      </Parameters>
    </DataConnection>
    <DataConnection Name="TAAPsCon" ProviderKey="MSSqlServer">
      <Parameters>
        <Parameter Name="server" Value="localhost" />
        <Parameter Name="database" Value="NasarawaTAAPs" />
        <Parameter Name="useIntegratedSecurity" Value="False" />
        <Parameter Name="read only" Value="1" />
        <Parameter Name="generateConnectionHelper" Value="false" />
      </Parameters>
    </DataConnection>
  </DataConnections>
  <DataSources>
    <DataSource ComponentName="dataSource1" Name="CollectionsOLAP">
      <OlapDataProvider DataConnection="CollectionsCubeCon" />
    </DataSource>
    <DataSource ComponentName="ForeignPayments" Name="ForeignPayments">
      <DataProvider DataConnection="firs_portalCon" SupportSql="true">
        <Selection>
          <Table Name="tbl_autoswift_payments">
            <Columns>
              <Column Name="autoswift_id" Alias="autoswift_id" />
              <Column Name="message_ref_num" Alias="message_ref_num" />
              <Column Name="payment_date" Alias="payment_date" />
              <Column Name="coll_bank_name" Alias="coll_bank_name" />
              <Column Name="cust_number" Alias="cust_number" />
              <Column Name="currency_type" Alias="currency_type" />
              <Column Name="tax_type" Alias="tax_type" />
              <Column Name="order_bank_name" Alias="order_bank_name" />
              <Column Name="inter_bank_name" Alias="inter_bank_name" />
              <Column Name="cust_name" Alias="cust_name" />
              <Column Name="payment_amount" Alias="payment_amount" />
              <Column Name="transaction_date" Alias="transaction_date" />
              <Column Name="msrepl_tran_version" Alias="msrepl_tran_version" />
            </Columns>
          </Table>
          <Filters>
            <Filter TableName="tbl_autoswift_payments" FilterString="" />
          </Filters>
        </Selection>
      </DataProvider>
    </DataSource>
    <DataSource ComponentName="dataSource2" Name="Data Source 1">
      <DataProvider DataConnection="firs_portalCon" SupportSql="true">
        <Selection>
          <Table Name="tbl_customers">
            <Columns>
              <Column Name="cust_number" Alias="cust_number" />
              <Column Name="cust_name" Alias="cust_name" />
              <Column Name="cust_business" Alias="cust_business" />
              <Column Name="cust_sub_location_code" Alias="cust_sub_location_code" />
              <Column Name="cust_sub_location_name" Alias="cust_sub_location_name" />
              <Column Name="cust_location_code" Alias="cust_location_code" />
              <Column Name="cust_location_name" Alias="cust_location_name" />
              <Column Name="cust_status" Alias="cust_status" />
              <Column Name="email_address" Alias="email_address" />
              <Column Name="employmentType" Alias="employmentType" />
              <Column Name="BusinessLineCode" Alias="BusinessLineCode" />
              <Column Name="taxpayerType" Alias="taxpayerType" />
              <Column Name="create_dt" Alias="create_dt" />
            </Columns>
          </Table>
          <Filters>
            <Filter TableName="tbl_customers" FilterString="[tbl_customers.cust_sub_location_code] = ?TaxOffice" />
          </Filters>
        </Selection>
      </DataProvider>
      <CalculatedFields>
        <CalculatedField Name="TaxpayerType" Expression="Iif([taxpayerType]=='C',  'Corporate','Indivudual' )" />
      </CalculatedFields>
    </DataSource>
    <DataSource ComponentName="dataSource3" Name="Local Payments">
      <DataProvider DataConnection="firs_portalCon" SupportSql="true">
        <Selection>
          <Table Name="tbl_payments_log">
            <Columns>
              <Column Name="payment_log_id" Alias="payment_log_id" />
              <Column Name="channel_id" Alias="channel_id" />
              <Column Name="channel_name" Alias="channel_name" />
              <Column Name="payment_log_date" Alias="payment_log_date" />
              <Column Name="payment_ref_num" Alias="payment_ref_num" />
              <Column Name="cust_number" Alias="cust_number" />
              <Column Name="cust_name" Alias="cust_name" />
              <Column Name="cust_location_code" Alias="cust_location_code" />
              <Column Name="cust_location_name" Alias="cust_location_name" />
              <Column Name="cust_sub_location_code" Alias="cust_sub_location_code" />
              <Column Name="cust_sub_location_name" Alias="cust_sub_location_name" />
              <Column Name="bank_name" Alias="bank_name" />
              <Column Name="cbn_bank_code" Alias="cbn_bank_code" />
              <Column Name="bank_code" Alias="bank_code" />
              <Column Name="payment_method_id" Alias="payment_method_id" />
              <Column Name="payment_method_name" Alias="payment_method_name" />
              <Column Name="payment_currency" Alias="payment_currency" />
            </Columns>
          </Table>
          <Table Name="tbl_payments_log_details">
            <References>
              <Reference Key="paylog_details_paylog_id" ParentKey="payment_log_id" ParentTable="tbl_payments_log" />
            </References>
            <Columns>
              <Column Name="paylog_details_amount" Alias="paylog_details_amount" />
              <Column Name="payment_type_code" Alias="payment_type_code" />
              <Column Name="payment_type_name" Alias="payment_type_name" />
            </Columns>
          </Table>
          <Filters>
            <Filter TableName="tbl_payments_log" FilterString="[tbl_payments_log.cust_sub_location_code] = ?TaxOffice" />
          </Filters>
        </Selection>
      </DataProvider>
      <CalculatedFields>
        <CalculatedField Name="AmountInNaira" Expression="[paylog_details_amount]/100.00" DataType="Decimal" />
      </CalculatedFields>
    </DataSource>
    <DataSource ComponentName="dataSource4" Name="RevenueTargets">
      <DataProvider DataConnection="TAAPsCon" SupportSql="true">
        <Selection>
          <Table Name="RevenueTargets">
            <Columns>
              <Column Name="TaxOfficeId" Alias="TaxOfficeId" />
              <Column Name="Year" Alias="Year" />
              <Column Name="Target" Alias="Target" />
            </Columns>
          </Table>
          <Filters>
            <Filter TableName="RevenueTargets" FilterString="" />
          </Filters>
        </Selection>
      </DataProvider>
    </DataSource>
    <DataSource ComponentName="dataSource5" Name="Tax Offices">
      <DataProvider DataConnection="TAAPsCon" SupportSql="true">
        <Selection>
          <Table Name="TaxOffices">
            <Columns>
              <Column Name="TaxOfficeId" Alias="TaxOfficeId" />
              <Column Name="TaxOfficeName" Alias="TaxOfficeName" />
              <Column Name="TaxOfficeTypeId" Alias="TaxOfficeTypeId" />
              <Column Name="RegionId" Alias="RegionId" />
              <Column Name="Street" Alias="Street" />
              <Column Name="City" Alias="City" />
              <Column Name="LGAId" Alias="LGAId" />
              <Column Name="Telephone" Alias="Telephone" />
              <Column Name="TaxOfficerName" Alias="TaxOfficerName" />
              <Column Name="TaxOfficerPhone" Alias="TaxOfficerPhone" />
              <Column Name="IsActive" Alias="IsActive" />
              <Column Name="CreateDate" Alias="CreateDate" />
              <Column Name="CreatedBy" Alias="CreatedBy" />
            </Columns>
          </Table>
          <Filters>
            <Filter TableName="TaxOffices" FilterString="" />
          </Filters>
        </Selection>
      </DataProvider>
    </DataSource>
  </DataSources>
  <Parameters>
    <Parameter Name="TaxOffice" Value="">
      <DynamicListLookUpSettings DataSourceName="dataSource5" ValueMember="TaxOfficeId" DisplayMember="TaxOfficeName" />
    </Parameter>
  </Parameters>
  <Items>
    <Card ComponentName="cardDashboardItem1" Name="Registered Taxpayers" DataSource="dataSource2" IgnoreMasterFilters="true" ContentLineCount="2">
      <DataItems>
        <Dimension DataMember="TaxpayerType" UniqueName="DataItem0" />
        <Measure DataMember="cust_number" SummaryType="Count" UniqueName="DataItem1">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
      </DataItems>
      <SeriesDimensions>
        <SeriesDimension UniqueName="DataItem0" />
      </SeriesDimensions>
      <Card>
        <ActualValue UniqueName="DataItem1" />
      </Card>
    </Card>
    <Pie ComponentName="pieDashboardItem1" Name="Collections by Tax Type" DataSource="dataSource3" PieType="Donut" ContentLineCount="10" ShowPieCaptions="false">
      <DataItems>
        <Measure DataMember="AmountInNaira" UniqueName="DataItem0" Name="Amount" />
        <Dimension DataMember="payment_type_code" UniqueName="DataItem2" Name="Tax Type" />
      </DataItems>
      <Arguments>
        <Argument UniqueName="DataItem2" />
      </Arguments>
      <Values>
        <Value UniqueName="DataItem0" />
      </Values>
    </Pie>
    <Chart ComponentName="chartDashboardItem1" Name="Annual Collections" DataSource="dataSource3">
      <DataItems>
        <Dimension DataMember="payment_log_date" UniqueName="DataItem0" Name="Payment Date (Year)" />
        <Measure DataMember="AmountInNaira" UniqueName="DataItem1" Name="Amount">
          <NumericFormat FormatType="Number" Unit="Millions" IncludeGroupSeparator="true" />
        </Measure>
      </DataItems>
      <Arguments>
        <Argument UniqueName="DataItem0" />
      </Arguments>
      <InteractivityOptions MasterFilterMode="Single" />
      <Panes>
        <Pane Name="Pane 1">
          <AxisY Title="Amount" TitleVisible="false" />
          <Series>
            <Simple Name="Amount">
              <Value UniqueName="DataItem1" />
            </Simple>
          </Series>
        </Pane>
      </Panes>
      <ChartLegend Visible="false" IsInsidePosition="true" />
    </Chart>
    <Chart ComponentName="chartDashboardItem3" Name="Monthly Collections" DataSource="dataSource3">
      <DataItems>
        <Dimension DataMember="payment_log_date" DateTimeGroupInterval="Month" UniqueName="DataItem0" Name="Payment Date (Month)">
          <DateTimeFormat MonthFormat="Abbreviated" />
        </Dimension>
        <Measure DataMember="AmountInNaira" UniqueName="DataItem2" Name="Amount" />
      </DataItems>
      <Arguments>
        <Argument UniqueName="DataItem0" />
      </Arguments>
      <Panes>
        <Pane Name="Pane 1">
          <AxisY Title="Amount" TitleVisible="false" />
          <Series>
            <Simple SeriesType="Line">
              <Value UniqueName="DataItem2" />
            </Simple>
          </Series>
        </Pane>
      </Panes>
      <ChartLegend Visible="false" />
    </Chart>
    <Chart ComponentName="chartDashboardItem2" Name="Quaterly Collections" DataSource="dataSource3">
      <DataItems>
        <Dimension DataMember="payment_log_date" DateTimeGroupInterval="Quarter" UniqueName="DataItem0" Name="Payment Date (Quarter)" />
        <Measure DataMember="AmountInNaira" UniqueName="DataItem1" Name="Amount">
          <NumericFormat FormatType="Number" Unit="Millions" IncludeGroupSeparator="true" />
        </Measure>
      </DataItems>
      <Arguments>
        <Argument UniqueName="DataItem0" />
      </Arguments>
      <Panes>
        <Pane Name="Pane 1">
          <AxisY TitleVisible="false" />
          <Series>
            <Simple>
              <Value UniqueName="DataItem1" />
            </Simple>
          </Series>
        </Pane>
      </Panes>
      <ChartLegend Visible="false" />
    </Chart>
  </Items>
  <LayoutTree>
    <LayoutGroup Orientation="Vertical">
      <LayoutGroup Weight="42.298850574712645">
        <LayoutItem Weight="44.63519313304721" DashboardItem="cardDashboardItem1" />
        <LayoutItem Weight="31.502145922746781" DashboardItem="chartDashboardItem1" />
        <LayoutItem Weight="23.862660944206009" DashboardItem="chartDashboardItem2" />
      </LayoutGroup>
      <LayoutGroup Weight="57.701149425287355">
        <LayoutItem Weight="69.27038626609442" DashboardItem="chartDashboardItem3" />
        <LayoutItem Weight="30.72961373390558" DashboardItem="pieDashboardItem1" />
      </LayoutGroup>
    </LayoutGroup>
  </LayoutTree>
</Dashboard>