<?xml version="1.0" encoding="utf-8"?>
<Dashboard CurrencyCulture="en-US">
  <Title Text="Revenue Analysis" />
  <DataConnections>
    <OlapDataConnection Name="CollectionsCubeCon" ConnectionString="provider=msolap;data source=local;initial catalog=FIRSCollectionsOLAP;timeout=1200;Cube Name=CollectionsCube;" />
    <DataConnection Name="firs_portalCon" ProviderKey="MSSqlServer">
      <Parameters>
        <Parameter Name="server" Value="localhost" />
        <Parameter Name="database" Value="firs_portal" />
        <Parameter Name="useIntegratedSecurity" Value="True" />
        <Parameter Name="read only" Value="1" />
        <Parameter Name="generateConnectionHelper" Value="false" />
      </Parameters>
    </DataConnection>
  </DataConnections>
  <DataSources>
    <DataSource ComponentName="dataSource1" Name="CollectionsOLAP">
      <OlapDataProvider DataConnection="CollectionsCubeCon" />
    </DataSource>
    <DataSource ComponentName="dataSource2" Name="Taxpayers">
      <DataProvider DataConnection="firs_portalCon" SupportSql="true">
        <Selection>
          <Table Name="tbl_customers">
            <Columns>
              <Column Name="cust_id" />
              <Column Name="cust_business" />
              <Column Name="cust_sub_location_code" />
              <Column Name="cust_sub_location_name" />
              <Column Name="cust_location_code" />
              <Column Name="cust_location_name" />
              <Column Name="BusinessLineCode" />
              <Column Name="taxpayerType" />
              <Column Name="create_dt" />
            </Columns>
          </Table>
        </Selection>
      </DataProvider>
      <CalculatedFields>
        <CalculatedField Name="TaxpayerType" Expression="Iif([taxpayerType]='I','Individual','Corporate' )" />
      </CalculatedFields>
    </DataSource>
  </DataSources>
  <Items>
    <Chart ComponentName="chartDashboardItem1" Name="Annual Revenue Analysis" DataSource="dataSource1">
      <DataItems>
        <Dimension DataMember="[Payment Date].[Payment Year].[Payment Year]" Name="DataItem2" />
        <Measure DataMember="[Measures].[Amount]" Name="DataItem1">
          <NumericFormat FormatType="Number" Unit="Millions" IncludeGroupSeparator="true" />
        </Measure>
        <Measure DataMember="[Measures].[Annual Target]" Name="DataItem0">
          <NumericFormat FormatType="Number" Unit="Millions" IncludeGroupSeparator="true" />
        </Measure>
      </DataItems>
      <Arguments>
        <Argument Name="DataItem2" />
      </Arguments>
      <InteractivityOptions MasterFilterMode="Multiple" />
      <Panes>
        <Pane Name="Pane 1">
          <Series>
            <Simple Name="Target">
              <Value Name="DataItem0" />
            </Simple>
            <Simple Name="Amount">
              <Value Name="DataItem1" />
            </Simple>
          </Series>
        </Pane>
      </Panes>
    </Chart>
    <Pie ComponentName="pieDashboardItem1" Name="Revenue by Tax Type" DataSource="dataSource1" PieType="Donut" ShowPieCaptions="false">
      <DataItems>
        <Measure DataMember="[Measures].[Amount]" Name="DataItem2">
          <NumericFormat FormatType="Number" Unit="Millions" IncludeGroupSeparator="true" />
        </Measure>
        <Dimension DataMember="[Tbl Payments Log].[Payment Type Code].[Payment Type Code]" Name="DataItem1" />
      </DataItems>
      <Arguments>
        <Argument Name="DataItem1" />
      </Arguments>
      <Values>
        <Value Name="DataItem2" />
      </Values>
    </Pie>
    <Pie ComponentName="pieDashboardItem2" Name="Taxpayers Summary" DataSource="dataSource2" ShowPieCaptions="false">
      <DataItems>
        <Measure DataMember="cust_id" SummaryType="Count" Name="DataItem0">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Dimension DataMember="TaxpayerType" Name="DataItem1" />
      </DataItems>
      <Arguments>
        <Argument Name="DataItem1" />
      </Arguments>
      <Values>
        <Value Name="DataItem0" />
      </Values>
      <Names>
        <Name Value="DataItem0" Name="cust_id (Count)" />
      </Names>
    </Pie>
    <Grid ComponentName="gridDashboardItem1" Name="Grid 1" DataSource="dataSource1">
      <DataItems>
        <Dimension DataMember="[Tax Offices].[Region Name].[Region Name]" SortOrder="Descending" Name="DataItem0" />
        <Measure DataMember="[Measures].[Amount]" Name="DataItem3">
          <NumericFormat FormatType="Number" Unit="Millions" IncludeGroupSeparator="true" />
        </Measure>
        <Measure DataMember="[Measures].[Amount]" Name="DataItem4" />
        <Measure DataMember="[Measures].[Annual Target]" Name="DataItem5" />
      </DataItems>
      <GridColumns>
        <GridDimensionColumn>
          <Dimension Name="DataItem0" />
        </GridDimensionColumn>
        <GridMeasureColumn>
          <Measure Name="DataItem3" />
        </GridMeasureColumn>
        <GridDeltaColumn>
          <ActualValue Name="DataItem4" />
          <TargetValue Name="DataItem5" />
          <DeltaOptions ValueType="PercentOfTarget" />
        </GridDeltaColumn>
      </GridColumns>
      <GridOptions />
    </Grid>
  </Items>
  <LayoutTree>
    <LayoutGroup>
      <LayoutGroup Weight="48.918918918918919" Orientation="Vertical">
        <LayoutItem Weight="54.252873563218394" DashboardItem="chartDashboardItem1" />
        <LayoutItem Weight="45.747126436781606" DashboardItem="pieDashboardItem1" />
      </LayoutGroup>
      <LayoutGroup Weight="51.081081081081081">
        <LayoutItem Weight="66.843033509700177" DashboardItem="gridDashboardItem1" />
        <LayoutItem Weight="33.156966490299823" DashboardItem="pieDashboardItem2" />
      </LayoutGroup>
    </LayoutGroup>
  </LayoutTree>
</Dashboard>